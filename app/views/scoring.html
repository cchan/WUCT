<html>
<head>
  <script src="https://www.gstatic.com/firebasejs/3.6.9/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.9/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.9/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.9/firebase-messaging.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.9/firebase.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.3/css/bootstrap.min.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="main.css" />
</head>
<body>
  <div id="app">
    <header>
      <h1><img src="wuct.jpg" alt="WUCT" />Breaking Bonds Round: Scoring</h1>
      <a href="#" className="add" onClick={this.addCard.bind(this)}><i className="fa fa-plus" aria-hidden="true"></i></a>
      <a href="#" className="signout" onClick={function(){window.signOut()}}><i className="fa fa-sign-out" aria-hidden="true"></i></a>
    </header>
    <input type="password" id="password" />
    <input type="submit" id="passsubmit" value="Log In" />
  </div>

  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyC4siYV0A1Nq4POMUfvdRKyP0-xzUUvMVo",
      authDomain: "wuct-1f4ca.firebaseapp.com",
      databaseURL: "https://wuct-1f4ca.firebaseio.com",
      storageBucket: "wuct-1f4ca.appspot.com",
      messagingSenderId: "833633709327"
    };
    firebase.initializeApp(config);
    var fb = firebase.database().ref('wuct2017');
  </script>
  <script src="bundle.js"></script>
  <script>
    window.cancelAuthStateChanged = false;
    window.signOut = function(){
      window.cancelAuthStateChanged = true;
      firebase.auth().signOut();
      window.location.reload();
    }
    firebase.auth().onAuthStateChanged(function(user){
      if(window.cancelAuthStateChanged)
        return;
      
      console.log('attempt');
      if (user) {
        if(user.email != 'wuct@clive.io')
          window.signOut();
        else
          window.render();
      }
    });
    document.getElementById('password').onkeypress = function(e){
      if(e.keyCode == 13)
        document.getElementById('passsubmit').click();
    }
    document.getElementById('passsubmit').onclick = function(e){
      var password = document.getElementById('password').value;
      if(!password)
        document.getElementById('app').innerHTML = 'failed to sign in';
      else
        firebase.auth().signInWithEmailAndPassword('wuct@clive.io', password).then(window.render).catch(function(error){
          document.getElementById('app').innerHTML = 'failed to sign in';
        });
      e.preventDefault();
      return false;
    };
  </script>
</body>
</html>
