{"version":3,"sources":["common.js"],"names":["window","dClass","dTitle","numPackets","numPacketsDict","easy","medium","hard","scoreValues","location","hostname","dbName","URLSearchParams","search","get","port","Error","console","log","getScore","scores","totalScore","i","length","map","a","reduce","b","getProgress","progress","findIndex","fbconfig","apiKey","authDomain","databaseURL","storageBucket","messagingSenderId","setTimer","el","cb","timerlength","currentTarget","fb","child","on","snapshot","val","target","setInterval","total","Math","floor","Date","getTime","hours","minutes","seconds","innerHTML","alertSuccess","text","persistent","$","hide","fadeTo","slideUp","alertFailure","firebase","initializeApp","database","ref","append","connectedRef","parseIntFull","x","test","Number","NaN","snap","s","o","g","r","m","q","push","arguments","l","createElement","getElementsByTagName","async","src","parentNode","insertBefore","document","ga"],"mappings":"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","file":"common.min.js","sourcesContent":["// note the the number of difficulty classes is fixed at 3, for now\nwindow.dClass = [\"easy\", \"medium\", \"hard\"];\nwindow.dTitle = [\"Easy\", \"Med\", \"Hard\"];\nwindow.numPackets = [21, 14, 9];\nwindow.numPacketsDict = {\"easy\": 21, \"medium\": 14, \"hard\": 9};\nwindow.scoreValues = [1, 3, 7];\n\nif(window.location.hostname == 'wuct.clive.io')\n  window.dbName = new URLSearchParams(window.location.search).get(\"db\") || 'wuct2024china';\nelse if (window.location.hostname == 'localhost' && window.location.port == 8849)\n  window.dbName = new URLSearchParams(window.location.search).get(\"db\") || 'wuct2024china';\nelse\n  throw new Error();\nconsole.log(window.dbName);\n\nwindow.getScore = function(scores){\n  var totalScore = 0;\n  for(var i = 0; i < window.dClass.length; i++)\n    totalScore += (scores[window.dClass[i]] || scores[i] || []).map(function(a){\n      if(a == -1)\n        return 0;\n      if(a == 3)\n        a++;\n      return a*window.scoreValues[i];\n    }).reduce(function(a,b){return a+b;}, 0);\n  return totalScore;\n}\nwindow.getProgress = function(scores){\n  var progress = [];\n  for(var i = 0; i < window.dClass.length; i++){\n    progress[i] = scores[window.dClass[i]] ? scores[window.dClass[i]].findIndex(a => a == -1) : 0; // Number they finished\n    if(progress[i] == -1)\n      progress[i] = scores[window.dClass[i]].length;\n    progress[i] /= numPackets[i];\n  }\n  return progress;\n}\n\n// Initialize Firebase\nvar fbconfig = {\n  apiKey: \"AIzaSyC4siYV0A1Nq4POMUfvdRKyP0-xzUUvMVo\",\n  authDomain: \"wuct-1f4ca.firebaseapp.com\",\n  databaseURL: \"https://wuct-1f4ca.firebaseio.com\",\n  storageBucket: \"wuct-1f4ca.appspot.com\",\n  messagingSenderId: \"833633709327\"\n};\nfirebase.initializeApp(fbconfig);\nwindow.fb = firebase.database().ref(window.dbName);\n\n//Don't use this during leap seconds btw.\nfunction setTimer(el, cb){\n  var timerlength, currentTarget = 0;\n  fb.child('timer').on('value', function(snapshot){\n    if(snapshot.val()){\n      currentTarget = snapshot.val().target;\n      timerlength = snapshot.val().timerlength;\n    }\n  });\n  return setInterval(function(){\n    var total = Math.floor((currentTarget - (new Date()).getTime())/1000);\n    if(cb)\n      cb(total);\n    if(total > timerlength * 60)\n      total = timerlength * 60;\n    if(total < 0)\n      total = 0;\n    var hours = \"\" + Math.floor(total/3600);\n    var minutes = \"\" + Math.floor(total/60) % 60;\n    var seconds = \"\" + total % 60;\n    el.innerHTML = ((hours<10)?\"0\":\"\") + hours + \":\" + ((minutes<10)?\"0\":\"\") + minutes + \":\" + ((seconds<10)?\"0\":\"\") + seconds;\n  }, 500);\n}\n\n\nfunction alertSuccess(text, persistent) {\n    $(\"#success-alert\").hide();\n    $(\"#failure-alert\").hide();\n    $(\"#success-alert\").text(text).fadeTo(2000, 500);\n    if(!persistent)\n      $(\"#success-alert\").slideUp(500, function(){\n         $(\"#success-alert\").slideUp(3000);\n      });\n}\nfunction alertFailure(text, persistent) {\n    $(\"#success-alert\").hide();\n    $(\"#failure-alert\").hide();\n    $(\"#failure-alert\").text(text).fadeTo(2000, 500);\n    if(!persistent)\n      $(\"#failure-alert\").slideUp(500, function(){\n         $(\"#failure-alert\").slideUp(3000);\n      });\n}\n$(function(){\n  $('body').append(`<div class=\"alerts\" style=\"position: fixed; top: 4em; left: 1em; right: 1em; height: 4em; pointer-events: none;\">\n    <div class=\"alert alert-success\" id=\"success-alert\" style=\"position:absolute; width: 15em; right: 1em; text-align: center;\"></div>\n    <div class=\"alert alert-danger\" id=\"failure-alert\" style=\"position:absolute; width: 15em; right: 1em; text-align: center;\"></div>\n  </div>`);\n  $(\"#success-alert\").hide();\n  $(\"#failure-alert\").hide();\n});\n\nvar connectedRef = firebase.database().ref(\".info/connected\");\nconnectedRef.on(\"value\", function(snap) {\n  if (snap.val() === true) {\n    alertSuccess(\"connected\");\n  } else {\n    alertFailure(\"not connected\", true);\n  }\n});\n\n// A better parseInt from https://stackoverflow.com/a/4168683\nfunction parseIntFull(x) {\n  if ( typeof x === \"string\" && /^\\s*(\\+|-)?\\d+\\s*$/.test(x) ) {\n      x = Number(x);\n  }\n  if ( typeof x === \"number\" ) {\n      return x === Math.floor(x) ? x : NaN;\n  }\n  return NaN;\n}\n\n\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\n\nga('create', 'UA-62605323-4', 'auto');\nga('send', 'pageview');\n\n"]}